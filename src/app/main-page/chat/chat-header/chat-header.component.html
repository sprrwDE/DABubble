<header
  class="z-10 bg-white flex rounded-t-[30px] min-h-[60px] md:min-h-[100px] justify-between items-center px-[16px] py-[10px] md:px-[45px] md:py-[25px] absolute top-0 left-0 w-full"
  [ngClass]="{
    'max-h-[60px] md:max-h-[100px]': !searchChat && !isDirectChat,
    'shadow-[0px_2px_10px_0px_#00000014]': !searchChat,
    'max-h-[unset] shadow-[0]': searchChat,
    'max-h-[100px] md:max-h-[110px]': isDirectChat
  }"
>
  <!-- chat name -->
  <div
    *ngIf="!isDirectChat && !searchChat"
    (click)="openChannelDetailsPopup()"
    class="hover-primary-bg relative rounded-[100px] max-w-[70%] px-[10px] py-[6px] transition-svg-text flex items-center gap-[10px]"
  >
    <svg
      class="min-h-[27px] min-w-[32px] h-[27px] w-[32px] md:h-[33px] md:min-h-[33px]"
      viewBox="0 0 32 33"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M9.65649 28C9.23359 28 8.88859 27.8203 8.6215 27.4609C8.3544 27.1016 8.2765 26.7062 8.38779 26.275L9.32262 22.25H6.35119C5.90603 22.25 5.5499 22.0646 5.28281 21.6937C5.01571 21.3219 4.93781 20.9083 5.0491 20.4531C5.11587 20.1177 5.27168 19.8542 5.51652 19.6625C5.76135 19.4708 6.03958 19.375 6.35119 19.375H9.99036L11.3258 13.625H7.68666C7.2415 13.625 6.88538 13.4396 6.61828 13.0687C6.35119 12.6969 6.27328 12.2833 6.38457 11.8281C6.45135 11.4927 6.60715 11.2292 6.85199 11.0375C7.09683 10.8458 7.37505 10.75 7.68666 10.75H11.9936L13.0953 6.04219C13.1621 5.73073 13.3068 5.47917 13.5294 5.2875C13.7519 5.09583 14.019 5 14.3307 5C14.7536 5 15.0986 5.17969 15.3656 5.53906C15.6327 5.89844 15.7106 6.29375 15.5994 6.725L14.6645 10.75H20.0064L21.1082 6.04219C21.175 5.73073 21.3196 5.47917 21.5422 5.2875C21.7648 5.09583 22.0319 5 22.3435 5C22.7664 5 23.1114 5.17969 23.3785 5.53906C23.6456 5.89844 23.7235 6.29375 23.6122 6.725L22.6774 10.75H25.6488C26.094 10.75 26.4501 10.9354 26.7172 11.3063C26.9843 11.6781 27.0622 12.0917 26.9509 12.5469C26.8841 12.8823 26.7283 13.1458 26.4835 13.3375C26.2386 13.5292 25.9604 13.625 25.6488 13.625H22.0096L20.6742 19.375H24.3133C24.7585 19.375 25.1146 19.5604 25.3817 19.9313C25.6488 20.3031 25.7267 20.7167 25.6154 21.1719C25.5487 21.5073 25.3928 21.7708 25.148 21.9625C24.9032 22.1542 24.6249 22.25 24.3133 22.25H20.0064L18.9047 26.9578C18.8379 27.2693 18.6932 27.5208 18.4706 27.7125C18.2481 27.9042 17.981 28 17.6693 28C17.2464 28 16.9014 27.8203 16.6344 27.4609C16.3673 27.1016 16.2894 26.7062 16.4006 26.275L17.3355 22.25H11.9936L10.8918 26.9578C10.825 27.2693 10.6804 27.5208 10.4578 27.7125C10.2352 27.9042 9.9681 28 9.65649 28ZM12.6613 19.375H18.0032L19.3387 13.625H13.9968L12.6613 19.375Z"
        fill="black"
      />
    </svg>

    <h2 class="text-[20px] truncate max-w-[100%] md:text-[24px] font-bold">
      {{ currentChannel.name || "lädt..." }}
    </h2>

    <svg
      class="px-[8px] box-content"
      width="14"
      height="9"
      viewBox="0 0 14 9"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M7 8.59375C6.83259 8.59375 6.67061 8.5625 6.51408 8.5C6.35671 8.4375 6.22571 8.35417 6.12108 8.25L0.345291 2.5C0.115097 2.27083 0 1.97917 0 1.625C0 1.27083 0.115097 0.979166 0.345291 0.75C0.575485 0.520833 0.86846 0.40625 1.22422 0.40625C1.57997 0.40625 1.87294 0.520833 2.10314 0.75L7 5.625L11.8969 0.75C12.1271 0.520833 12.42 0.40625 12.7758 0.40625C13.1315 0.40625 13.4245 0.520833 13.6547 0.75C13.8849 0.979166 14 1.27083 14 1.625C14 1.97917 13.8849 2.27083 13.6547 2.5L7.87892 8.25C7.75336 8.375 7.61734 8.46333 7.47085 8.515C7.32436 8.5675 7.16741 8.59375 7 8.59375Z"
        fill="black"
      />
    </svg>

    <app-popup
      class="hidden xl:block"
      [popupCorner]="'tl'"
      [popupOpen]="channelDetailsPopupOpen"
      [popupType]="'channel-details'"
      (closePopupEvent)="closeChannelDetailsPopup()"
    ></app-popup>
  </div>

  <!-- chat members -->
  <div
    #memberListContainer
    *ngIf="!isDirectChat && !searchChat"
    class="flex items-center w-[200px] justify-end gap-[15px] max-w-[50%]"
  >
    <div
      #memberListContainer
      *ngIf="this.currentChannel.users.length > 0 && !this.isMobile"
      class="relative hover-primary-bg min-w-[max-content] transition-svg-text rounded-[30px] px-[10px] py-[3px] flex items-center gap-[10px]"
      (click)="openMemberListPopup(false)"
    >
      <div class="flex items-center">
        <img
          *ngFor="let userId of currentChannel.users.slice(0, 3)"
          class="group-members-avatar"
          [src]="userService.getUserById(userId)?.image || 'imgs/avatar1.png'"
          (error)="globalVariablesService.handleImageError($event)"
          alt=""
        />
      </div>

      <p class="text-[20px] font-semibold">{{ currentChannel.users.length }}</p>
    </div>

    <div
      (click)="openMemberListPopup(isMobile ? false : true)"
      class="relative hover-primary transition-svg-text flex items-center justify-center bg-bg rounded-full p-[8px]"
    >
      <svg
        class="w-[18px] h-[18px] md:w-[24px] md:h-[24px]"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <mask
          id="mask0_104638_15727"
          style="mask-type: alpha"
          maskUnits="userSpaceOnUse"
          x="0"
          y="0"
          width="24"
          height="24"
        >
          <rect width="24" height="24" fill="#D9D9D9" />
        </mask>
        <g mask="url(#mask0_104638_15727)">
          <path
            d="M19 14C18.7167 14 18.4793 13.904 18.288 13.712C18.096 13.5207 18 13.2833 18 13V11H16C15.7167 11 15.4793 10.904 15.288 10.712C15.096 10.5207 15 10.2833 15 10C15 9.71667 15.096 9.479 15.288 9.287C15.4793 9.09567 15.7167 9 16 9H18V7C18 6.71667 18.096 6.479 18.288 6.287C18.4793 6.09567 18.7167 6 19 6C19.2833 6 19.5207 6.09567 19.712 6.287C19.904 6.479 20 6.71667 20 7V9H22C22.2833 9 22.5207 9.09567 22.712 9.287C22.904 9.479 23 9.71667 23 10C23 10.2833 22.904 10.5207 22.712 10.712C22.5207 10.904 22.2833 11 22 11H20V13C20 13.2833 19.904 13.5207 19.712 13.712C19.5207 13.904 19.2833 14 19 14ZM9 12C7.9 12 6.95833 11.6083 6.175 10.825C5.39167 10.0417 5 9.1 5 8C5 6.9 5.39167 5.95833 6.175 5.175C6.95833 4.39167 7.9 4 9 4C10.1 4 11.0417 4.39167 11.825 5.175C12.6083 5.95833 13 6.9 13 8C13 9.1 12.6083 10.0417 11.825 10.825C11.0417 11.6083 10.1 12 9 12ZM2 20C1.71667 20 1.47933 19.904 1.288 19.712C1.096 19.5207 1 19.2833 1 19V17.2C1 16.6333 1.146 16.1123 1.438 15.637C1.72933 15.1623 2.11667 14.8 2.6 14.55C3.63333 14.0333 4.68333 13.6457 5.75 13.387C6.81667 13.129 7.9 13 9 13C10.1 13 11.1833 13.129 12.25 13.387C13.3167 13.6457 14.3667 14.0333 15.4 14.55C15.8833 14.8 16.2707 15.1623 16.562 15.637C16.854 16.1123 17 16.6333 17 17.2V19C17 19.2833 16.904 19.5207 16.712 19.712C16.5207 19.904 16.2833 20 16 20H2ZM3 18H15V17.2C15 17.0167 14.9543 16.85 14.863 16.7C14.771 16.55 14.65 16.4333 14.5 16.35C13.6 15.9 12.6917 15.5623 11.775 15.337C10.8583 15.1123 9.93333 15 9 15C8.06667 15 7.14167 15.1123 6.225 15.337C5.30833 15.5623 4.4 15.9 3.5 16.35C3.35 16.4333 3.22933 16.55 3.138 16.7C3.046 16.85 3 17.0167 3 17.2V18ZM9 10C9.55 10 10.021 9.804 10.413 9.412C10.8043 9.02067 11 8.55 11 8C11 7.45 10.8043 6.97933 10.413 6.588C10.021 6.196 9.55 6 9 6C8.45 6 7.97933 6.196 7.588 6.588C7.196 6.97933 7 7.45 7 8C7 8.55 7.196 9.02067 7.588 9.412C7.97933 9.804 8.45 10 9 10Z"
            fill="black"
          />
        </g>
      </svg>

      <app-popup
        [popupCorner]="'tr'"
        [popupOpen]="memberListPopupOpen"
        [popupType]="'member-list'"
        (closePopupEvent)="closeMemberListPopup()"
      ></app-popup>
    </div>
  </div>

  <div
    *ngIf="isDirectChat && !searchChat"
    class="flex items-center gap-[15px] rounded-[30px] px-[8px] py-[4px] hover:bg-bg transition-svg-text cursor-pointer"
    (click)="openProfilePopup()"
  >
    <div class="relative">
      <img
        class="w-[50px] h-[50px] rounded-full"
        src="{{ currentDirectChatUser.image || 'imgs/avatar/profile.svg' }}"
        (error)="globalVariablesService.handleImageError($event)"
        alt=""
      />
      <div
        [ngClass]="{
          'bg-online': currentDirectChatUser.status === 'online',
          'bg-orange-400': currentDirectChatUser.status === 'abwesend',
          'bg-disable': currentDirectChatUser.status === 'offline'
        }"
        class="absolute bottom-0 right-0 h-[14px] w-[14px] rounded-full border-2 border-white"
      ></div>
    </div>

    <h2 class="text-[24px] font-bold">
      {{ currentDirectChatUser.name || "lädt..." }}
    </h2>
  </div>

  <!-- search chat -->
  <div class="flex flex-col relative gap-[20px] w-full" *ngIf="searchChat">
    <h2 class="text-[24px] font-bold">Neue Nachricht</h2>

    <div
      class="popup-input-container overflow-visible flex items-center"
      (click)="searchChatInput.focus()"
      (click)="showSearchPopup($event)"
    >
      <input
        type="text"
        #searchChatInput
        [(ngModel)]="searchChatService.searchChatInput"
        placeholder="An: #channel, oder @jemand oder E-Mail Adresse"
        (input)="searchChatService.searchChats()"
      />
    </div>

    <app-search-chat-popup></app-search-chat-popup>
  </div>
</header>
